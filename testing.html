<!-- index.html
Spine Decade Calendar ‚Äî 10 Years ‚Ä¢ 25 Reveals (2025)

Changes based on feedback:
‚úÖ Modal title feels like a ‚Äúgift reveal‚Äù (not ‚Äúdoor revealed‚Äù)
‚úÖ Added YEAR per release (shows clearly in modal)
‚úÖ Labels changed to: Launched, What was it?, Benefits, Impact, For whom
‚úÖ Header caption updated: ‚ÄúTen years. 25 updates. 2025.‚Äù
‚úÖ Tiles still show ONLY icon + category + number (no names)

Note:
- Years are placeholders right now. Replace the year values in DOORS with your real timeline.
-->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Spine Decade Calendar</title>

  <style>
    :root{
      --bg:#0e1014;
      --text:#eef2ff;
      --muted:#aab2c5;
      --border:rgba(255,255,255,.09);
      --accent:#7c5cff;
      --accent2:#00d4ff;
      --ok:#2dd4bf;
      --shadow: 0 20px 60px rgba(0,0,0,.55);
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:
        radial-gradient(1200px 700px at 10% 10%, rgba(124,92,255,.18), transparent 55%),
        radial-gradient(900px 600px at 90% 30%, rgba(0,212,255,.12), transparent 55%),
        var(--bg);
      color:var(--text);
      min-height:100vh;
    }

    header{
      max-width:1200px;
      margin:0 auto;
      padding:26px 18px 10px;
      display:flex;
      gap:16px;
      align-items:flex-end;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .brand h1{ margin:0; font-size:28px; letter-spacing:.2px; }
    .brand p{
      margin:8px 0 0;
      color:var(--muted);
      font-size:14px;
      line-height:1.45;
      max-width:900px;
    }

    .actions{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .btn{
      cursor:pointer;
      border:1px solid var(--border);
      background:rgba(255,255,255,.04);
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      font-weight:850;
      transition:transform .06s ease, background .15s ease, border-color .15s ease;
    }
    .btn:hover{ background:rgba(255,255,255,.07); }
    .btn:active{ transform:translateY(1px); }
    .btn.primary{
      border-color:rgba(124,92,255,.55);
      background:linear-gradient(135deg, rgba(124,92,255,.35), rgba(0,212,255,.22));
    }

    .wrap{
      max-width:1200px;
      margin:0 auto;
      padding:10px 18px 40px;
    }

    .panel{
      background: linear-gradient(180deg, rgba(255,255,255,.045), rgba(255,255,255,.02));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .panel-head{
      padding:14px 16px;
      border-bottom:1px solid var(--border);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      background:rgba(255,255,255,.02);
    }
    .panel-head h2{
      margin:0;
      font-size:14px;
      letter-spacing:.2px;
      color:var(--muted);
      font-weight:950;
      text-transform:uppercase;
    }

    .progress{
      display:flex;
      align-items:center;
      gap:10px;
      color:var(--muted);
      font-size:13px;
      white-space:nowrap;
    }
    .bar{
      width:260px;
      height:10px;
      background:rgba(255,255,255,.06);
      border-radius:999px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.07);
    }
    .bar > i{
      display:block;
      height:100%;
      width:0%;
      background:linear-gradient(90deg, rgba(124,92,255,.95), rgba(0,212,255,.9));
      border-radius:999px;
      transition:width .2s ease;
    }

    /* Uniform grid */
    .grid{
      padding:16px;
      display:grid;
      grid-template-columns: repeat(5, minmax(0, 1fr));
      gap:12px;
    }

    .tile{
      position:relative;
      border-radius:16px;
      background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border:1px solid var(--border);
      padding:14px;
      cursor:pointer;
      user-select:none;
      transition:transform .08s ease, border-color .15s ease, background .15s ease;
      overflow:hidden;

      height:140px;
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;
      gap:10px;
      text-align:center;
    }
    .tile:hover{
      transform:translateY(-1px);
      border-color:rgba(124,92,255,.35);
      background:linear-gradient(180deg, rgba(124,92,255,.10), rgba(255,255,255,.02));
    }

    .icon{
      width:60px;
      height:60px;
      border-radius:18px;
      display:grid;
      place-items:center;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.03);
      font-size:32px;
      line-height:1;
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
    }

    .cat{
      font-size:12px;
      color:var(--muted);
      border:1px solid var(--border);
      background:rgba(255,255,255,.03);
      padding:6px 10px;
      border-radius:999px;
      max-width:100%;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }

    .doorno{
      position:absolute;
      top:12px; left:12px;
      font-size:12px;
      color:rgba(255,255,255,.75);
      font-weight:900;
      letter-spacing:.12em;
      padding:6px 8px;
      border-radius:10px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.03);
    }

    .tile .check{
      position:absolute;
      top:12px; right:12px;
      width:26px; height:26px;
      border-radius:10px;
      display:grid; place-items:center;
      border:1px solid rgba(45,212,191,.35);
      background:rgba(45,212,191,.12);
      color:var(--ok);
      opacity:0;
      transform:scale(.95);
      transition:opacity .15s ease, transform .15s ease;
    }
    .tile.opened .check{ opacity:1; transform:scale(1); }

    .tile .glow{
      position:absolute;
      inset:auto -60px -60px auto;
      width:160px; height:160px;
      border-radius:50%;
      background:radial-gradient(circle at 30% 30%, rgba(0,212,255,.18), transparent 60%);
      filter:blur(2px);
      pointer-events:none;
    }

    /* Modal */
    .modal{
      position:fixed; inset:0;
      background:rgba(0,0,0,.55);
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index:50;
    }
    .modal.show{ display:flex; }
    .modal-card{
      width:min(840px, 100%);
      border-radius:22px;
      border:1px solid var(--border);
      background:linear-gradient(180deg, rgba(20,24,36,.96), rgba(10,12,18,.96));
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .modal-top{
      padding:14px 16px;
      border-bottom:1px solid var(--border);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    .modal-title{
      font-weight:950;
      line-height:1.2;
      display:flex;
      align-items:center;
      gap:10px;
      flex-wrap:wrap;
    }
    .year-pill{
      font-size:12px;
      font-weight:900;
      letter-spacing:.12em;
      color:rgba(255,255,255,.8);
      padding:7px 10px;
      border-radius:999px;
      border:1px solid rgba(124,92,255,.4);
      background:rgba(124,92,255,.12);
    }
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius:999px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.03);
      color:var(--muted);
      font-size:12px;
      margin-top:8px;
      flex-wrap:wrap;
    }
    .x{
      width:36px; height:36px;
      border-radius:12px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.04);
      color:var(--text);
      cursor:pointer;
      display:grid;
      place-items:center;
      font-weight:950;
      font-size:18px;
    }
    .modal-body{ padding:16px; }

    .visual{
      width:100%;
      border-radius:16px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.02);
      overflow:hidden;
      margin:10px 0 14px;
    }
    .visual img{
      width:100%;
      display:block;
      max-height:280px;
      object-fit:cover;
    }

    .gallery{
      display:grid;
      grid-template-columns: repeat(4, minmax(0,1fr));
      gap:10px;
    }
    .thumb{
      border-radius:14px;
      overflow:hidden;
      border:1px solid var(--border);
      background:rgba(255,255,255,.02);
      cursor:pointer;
      transition:transform .08s ease, border-color .15s ease;
    }
    .thumb:hover{ transform:translateY(-1px); border-color:rgba(124,92,255,.35); }
    .thumb img{ width:100%; height:86px; object-fit:cover; display:block; }

    .block{
      margin:12px 0;
      padding:12px;
      border-radius:16px;
      background:rgba(255,255,255,.02);
      border:1px solid var(--border);
    }
    .block .k{
      font-size:12px;
      color:var(--muted);
      text-transform:uppercase;
      letter-spacing:.12em;
      font-weight:950;
    }
    .block .v{
      margin-top:6px;
      font-size:14px;
      line-height:1.55;
      color:var(--text);
      white-space:pre-line;
    }

    footer{
      max-width:1200px;
      margin:0 auto;
      padding:0 18px 28px;
      color:var(--muted);
      font-size:12px;
      opacity:.85;
    }

    @media (max-width: 980px){
      .grid{ grid-template-columns: repeat(4, minmax(0, 1fr)); }
      .bar{ width:180px; }
    }
    @media (max-width: 640px){
      .grid{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
      .bar{ width:140px; }
    }
    @media (max-width: 420px){
      .grid{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
      .tile{ height:135px; }
      .icon{ width:56px; height:56px; font-size:30px; }
    }
  </style>
</head>

<body>
  <header>
    <div class="brand">
      <h1>üéÅ Spine Decade Calendar</h1>
      <p><b>Ten years.</b> <b>25 updates.</b> <b>2025.</b> Tap any box to open a ‚Äúgift‚Äù and discover what shipped, why it mattered, and who it helped.</p>
    </div>

    <div class="actions">
      <button class="btn primary" id="random">Open a random gift</button>
      <button class="btn" id="reset">Reset + Shuffle</button>
    </div>
  </header>

  <main class="wrap">
    <section class="panel">
      <div class="panel-head">
        <h2>Calendar</h2>
        <div class="progress">
          <span id="count">0/25 opened</span>
          <div class="bar"><i id="barFill"></i></div>
        </div>
      </div>
      <div class="grid" id="grid"></div>
    </section>
  </main>

  <!-- Modal -->
  <div class="modal" id="modal" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-modal="true" aria-label="Gift details">
      <div class="modal-top">
        <div>
          <div class="modal-title" id="modalTitle"></div>
          <div class="badge" id="modalBadge"></div>
        </div>
        <button class="x" id="close">√ó</button>
      </div>

      <div class="modal-body">
        <div class="visual" id="modalVisual" style="display:none"></div>

        <div class="block" id="modalGalleryWrap" style="display:none">
          <div class="k">Gallery</div>
          <div class="v" style="margin-top:10px;">
            <div class="gallery" id="modalGallery"></div>
          </div>
        </div>

        <div class="block">
          <div class="k">Launched</div>
          <div class="v" id="modalLaunched"></div>
        </div>

        <div class="block">
          <div class="k">What was it?</div>
          <div class="v" id="modalWhat"></div>
        </div>

        <div class="block">
          <div class="k">Benefits</div>
          <div class="v" id="modalBenefits"></div>
        </div>

        <div class="block">
          <div class="k">Impact</div>
          <div class="v" id="modalImpact"></div>
        </div>

        <div class="block">
          <div class="k">For whom</div>
          <div class="v" id="modalForWhom"></div>
        </div>
      </div>
    </div>
  </div>

  <footer>
    Hosting note: recommended to host on your internal <code>iamluna.ai</code> setup (Server team can deploy quickly).
  </footer>

  <script>
    // =============================
    // DATA
    // Add real years for each milestone.
    // =============================
    const DOORS = [
      // NextGen ERP
      { id:1, year:2017, emoji:"üß†", series:"NextGen ERP",
        launched:"SpineNEXTGEN ERP",
        what:"Next-generation ERP connecting planning, production, quality, warehouse, finance, HR, sales and procurement.",
        benefits:"‚Ä¢ Faster workflows and approvals\n‚Ä¢ Unified data across teams\n‚Ä¢ Reduced manual work with automation",
        impact:"Created a single operational backbone for daily business processes.",
        forWhom:"Ops + Finance + QA + HR"
      },
      { id:2, year:2018, emoji:"üß©", series:"NextGen ERP",
        launched:"NextGen Modules Rollout",
        what:"Inventory, PPC, QC/QA, WMS, HRM, Accounts, Sales, Purchase.",
        benefits:"‚Ä¢ End-to-end process coverage\n‚Ä¢ Cleaner reporting\n‚Ä¢ Less duplication",
        impact:"Made ERP usable across functions, not just one department.",
        forWhom:"Ops + HR + Finance + QA"
      },
      { id:3, year:2019, emoji:"‚öôÔ∏è", series:"NextGen ERP",
        launched:"ERP Automation Layer",
        what:"Auto vouchers, alerts/notifications, auto-emails and configurable reports.",
        benefits:"‚Ä¢ Faster processing cycles\n‚Ä¢ Lower entry errors\n‚Ä¢ More consistent reporting",
        impact:"Saved time on repetitive operations and improved accuracy.",
        forWhom:"Finance + Operations"
      },
      { id:4, year:2019, emoji:"‚úÖ", series:"NextGen ERP",
        launched:"Compliance Controls",
        what:"Audit trail, access controls, GST/tax support and compliance-ready workflows.",
        benefits:"‚Ä¢ Better traceability\n‚Ä¢ Easier audits\n‚Ä¢ Stronger controls",
        impact:"Improved governance and audit readiness across workflows.",
        forWhom:"Finance + QA + Compliance"
      },
      { id:5, year:2020, emoji:"üìà", series:"NextGen ERP",
        launched:"Scale & Performance",
        what:"Stability for heavy daily transactions and multi-location operations.",
        benefits:"‚Ä¢ More reliable daily usage\n‚Ä¢ Faster handling at scale\n‚Ä¢ Better uptime confidence",
        impact:"Operations stayed stable as usage and volumes grew.",
        forWhom:"All users"
      },

      // Online Billing
      { id:6, year:2016, emoji:"üßæ", series:"Online Billing",
        launched:"PharmaTrader",
        what:"Online billing and distributor operations software for trade workflows.",
        benefits:"‚Ä¢ Faster billing\n‚Ä¢ Reduced mistakes\n‚Ä¢ Better distributor workflow tracking",
        impact:"Accelerated billing and improved trade efficiency.",
        forWhom:"Trade Team + Distributors"
      },
      { id:7, year:2017, emoji:"üßæ", series:"Online Billing",
        launched:"SpineTrader",
        what:"Billing and trade management suite with structured processes and consistent data.",
        benefits:"‚Ä¢ Standardized billing\n‚Ä¢ Better transaction visibility\n‚Ä¢ Improved control",
        impact:"Helped scale billing operations across partners.",
        forWhom:"Trade + Retail Network"
      },
      { id:8, year:2021, emoji:"üõ°Ô∏è", series:"Online Billing",
        launched:"Zero-Disruption Upgrades",
        what:"Planned upgrades/migrations executed without business disruption.",
        benefits:"‚Ä¢ Continuity protected\n‚Ä¢ Reduced downtime\n‚Ä¢ Faster recovery",
        impact:"Protected revenue operations during change windows.",
        forWhom:"Trade + IT"
      },

      // Mobile Apps
      { id:9, year:2018, emoji:"üì±", series:"Mobile Apps",
        launched:"Venus Ayushmaan",
        what:"Mobile access to product catalog and promotions for customers/distributors.",
        benefits:"‚Ä¢ Faster product access\n‚Ä¢ Better promo visibility\n‚Ä¢ More informed ordering",
        impact:"Improved speed and clarity for field communication.",
        forWhom:"Sales + Customers + Distributors"
      },
      { id:10, year:2018, emoji:"üñäÔ∏è", series:"Mobile Apps",
        launched:"Pen Order Booking",
        what:"Digitized pen order booking to reduce manual coordination.",
        benefits:"‚Ä¢ Faster booking\n‚Ä¢ Cleaner records\n‚Ä¢ Less follow-up load",
        impact:"Reduced friction in the order booking workflow.",
        forWhom:"Sales + Distributors"
      },
      { id:11, year:2019, emoji:"‚ö°", series:"Mobile Apps",
        launched:"Spine SFA",
        what:"Sales force automation for fast reporting and field activity capture.",
        benefits:"‚Ä¢ Faster reporting\n‚Ä¢ Better daily visibility\n‚Ä¢ Reduced paperwork",
        impact:"Made field execution and reporting quicker and more consistent.",
        forWhom:"Field Force + Managers"
      },
      { id:12, year:2020, emoji:"üíº", series:"Mobile Apps",
        launched:"Entrepreneur Program App",
        what:"Supports EP workflows like debit notes and departmental P/L insights.",
        benefits:"‚Ä¢ Better tracking\n‚Ä¢ Faster financial visibility\n‚Ä¢ Less manual reconciliation",
        impact:"Improved control and visibility in EP economics.",
        forWhom:"Business + Finance"
      },
      { id:13, year:2021, emoji:"üë•", series:"Mobile Apps",
        launched:"SpineHRM",
        what:"HR workflows on mobile for employee operations and requests.",
        benefits:"‚Ä¢ Faster HR turnaround\n‚Ä¢ Less paperwork\n‚Ä¢ Better employee experience",
        impact:"Simplified day-to-day HR operations.",
        forWhom:"HR + Employees"
      },
      { id:14, year:2021, emoji:"üèÜ", series:"Mobile Apps",
        launched:"PPL",
        what:"Gamified performance visibility for engagement and motivation.",
        benefits:"‚Ä¢ Clear performance view\n‚Ä¢ Higher engagement\n‚Ä¢ Faster recognition",
        impact:"Improved participation through visibility and gamification.",
        forWhom:"Sales + Teams"
      },
      { id:15, year:2022, emoji:"üöö", series:"Mobile Apps",
        launched:"Venus DTS",
        what:"Stockist ordering, tracking and payment workflows.",
        benefits:"‚Ä¢ Smoother ordering\n‚Ä¢ Better tracking\n‚Ä¢ Faster partner servicing",
        impact:"Reduced delays and improved partner operations.",
        forWhom:"Stockists + Sales + Trade"
      },
      { id:16, year:2022, emoji:"üåê", series:"Mobile Apps",
        launched:"Davai App",
        what:"B2B pharma transactions on mobile for faster execution on the go.",
        benefits:"‚Ä¢ Faster transactions\n‚Ä¢ Better accessibility\n‚Ä¢ Less dependency on desktop",
        impact:"Enabled trade execution from anywhere.",
        forWhom:"Trade + Partners"
      },
      { id:17, year:2023, emoji:"üì¶", series:"Mobile Apps",
        launched:"Mobile App Suite",
        what:"A portfolio of business apps across sales, trade, HR and programs.",
        benefits:"‚Ä¢ Mobile-first execution\n‚Ä¢ Faster field ops\n‚Ä¢ Better cross-team visibility",
        impact:"Moved multiple workflows from manual to mobile.",
        forWhom:"Sales + Trade + HR + Ops"
      },

      // Websites
      { id:18, year:2015, emoji:"üï∏Ô∏è", series:"Corporate Websites",
        launched:"50+ Corporate Websites",
        what:"Website rollout at scale across brands, products and business units.",
        benefits:"‚Ä¢ Stronger visibility\n‚Ä¢ Faster publishing\n‚Ä¢ Better customer access",
        impact:"Expanded digital footprint across the organization.",
        forWhom:"Marketing + Business + Customers",
        gallery:["assets/site_01.jpg","assets/site_02.jpg","assets/site_03.jpg","assets/site_04.jpg"]
      },
      { id:19, year:2024, emoji:"üì£", series:"Corporate Websites",
        launched:"SEO + Enquiry Funnels",
        what:"Publishing + optimization workflows improved for search and inbound enquiries.",
        benefits:"‚Ä¢ Higher organic visibility\n‚Ä¢ Better inbound experience\n‚Ä¢ More enquiries",
        impact:"Improved discoverability and lead capture.",
        forWhom:"Marketing + Sales"
      },

      // AI Software
      { id:20, year:2024, emoji:"ü§ñ", series:"AI Software",
        launched:"Bidcraft",
        what:"Smart bidding software using AI signals and optimization logic.",
        benefits:"‚Ä¢ Smarter bid recommendations\n‚Ä¢ Less manual analysis\n‚Ä¢ More consistent decisions",
        impact:"Made bid decisioning faster and more data-driven.",
        forWhom:"Business Teams + Leadership"
      },
      { id:21, year:2024, emoji:"üß†", series:"AI Software",
        launched:"Athena",
        what:"Intelligence layer for analysis, insights and decision workflows.",
        benefits:"‚Ä¢ Faster insights\n‚Ä¢ Better visibility\n‚Ä¢ Supports automation",
        impact:"Improved speed of analysis and decision-making.",
        forWhom:"Leadership + Analytics + Teams"
      },
      { id:22, year:2025, emoji:"üå™Ô∏è", series:"AI Software",
        launched:"Vortex",
        what:"AI engine for processing, pattern detection and intelligent workflows.",
        benefits:"‚Ä¢ Faster processing\n‚Ä¢ Better detection\n‚Ä¢ Smarter workflows",
        impact:"Enabled intelligent automation across use-cases.",
        forWhom:"IT + Operations + Business"
      },

      // Backbone + Wrap
      { id:23, year:2020, emoji:"üßØ", series:"Backbone",
        launched:"Monitoring & Alerts",
        what:"Proactive monitoring for critical services to catch issues early.",
        benefits:"‚Ä¢ Faster detection\n‚Ä¢ Quicker response\n‚Ä¢ Better uptime",
        impact:"Reduced downtime surprises and improved reliability.",
        forWhom:"Infra + DBA + IT Support"
      },
      { id:24, year:2019, emoji:"üõ°Ô∏è", series:"Backbone",
        launched:"Security Hardening",
        what:"Security and network upgrades to protect systems and ensure stable connectivity.",
        benefits:"‚Ä¢ Reduced risk\n‚Ä¢ Stronger controls\n‚Ä¢ Better reliability",
        impact:"Improved security posture across infrastructure.",
        forWhom:"IT + Security + All Users"
      },
      { id:25, year:2025, emoji:"üèÅ", series:"Wrap",
        launched:"Decade Wrap",
        what:"ERP + billing + mobile + websites + AI working together as one ecosystem.",
        benefits:"‚Ä¢ Faster operations\n‚Ä¢ Better visibility\n‚Ä¢ Stronger control\n‚Ä¢ Scalable foundation",
        impact:"The Spine ecosystem matured into a full business platform.",
        forWhom:"Everyone"
      },
    ];

    // State
    const STORAGE_OPENED = "spine_decade_opened_v6";
    const STORAGE_ORDER  = "spine_decade_order_v6";
    const state = {
      opened: new Set(JSON.parse(localStorage.getItem(STORAGE_OPENED) || "[]")),
      order: JSON.parse(localStorage.getItem(STORAGE_ORDER) || "null")
    };

    const $ = (sel) => document.querySelector(sel);
    const grid = $("#grid");
    const countEl = $("#count");
    const barFill = $("#barFill");

    // Modal nodes
    const modal = $("#modal");
    const modalTitle = $("#modalTitle");
    const modalBadge = $("#modalBadge");
    const modalVisual = $("#modalVisual");
    const modalGalleryWrap = $("#modalGalleryWrap");
    const modalGallery = $("#modalGallery");
    const modalLaunched = $("#modalLaunched");
    const modalWhat = $("#modalWhat");
    const modalBenefits = $("#modalBenefits");
    const modalImpact = $("#modalImpact");
    const modalForWhom = $("#modalForWhom");

    function save(){
      localStorage.setItem(STORAGE_OPENED, JSON.stringify([...state.opened]));
      localStorage.setItem(STORAGE_ORDER, JSON.stringify(state.order));
    }

    function shuffle(array){
      const a = array.slice();
      for (let i = a.length - 1; i > 0; i--){
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function ensureOrder(){
      if (Array.isArray(state.order) && state.order.length === DOORS.length) return;
      state.order = shuffle(DOORS.map(d => d.id));
      save();
    }

    function updateProgress(){
      const total = DOORS.length;
      const opened = state.opened.size;
      countEl.textContent = `${opened}/${total} opened`;
      barFill.style.width = `${Math.round((opened/total)*100)}%`;
    }

    function renderGrid(){
      grid.innerHTML = "";
      const idToDoor = new Map(DOORS.map(d => [d.id, d]));

      state.order.forEach((id) => {
        const d = idToDoor.get(id);
        if (!d) return;

        const opened = state.opened.has(d.id);
        const tile = document.createElement("div");
        tile.className = `tile ${opened ? "opened" : ""}`;
        tile.tabIndex = 0;

        // ONLY icon + category (series) + number
        tile.innerHTML = `
          <div class="doorno">${String(d.id).padStart(2,"0")}</div>
          <div class="check">‚úì</div>
          <div class="icon">${d.emoji || "üéÅ"}</div>
          <div class="cat" title="${d.series}">${d.series}</div>
          <div class="glow"></div>
        `;

        const open = () => {
          state.opened.add(d.id);
          save();
          updateProgress();
          tile.classList.add("opened");
          openModal(d);
        };

        tile.addEventListener("click", open);
        tile.addEventListener("keydown", (e) => {
          if (e.key === "Enter" || e.key === " ") {
            e.preventDefault();
            open();
          }
        });

        grid.appendChild(tile);
      });
    }

    function openModal(d, overrideVisual=null){
      // "Gift-like" title with year
      modalTitle.innerHTML = `
        <span style="font-size:18px;">üéÅ You opened a gift</span>
        <span class="year-pill">${d.year || "YEAR"}</span>
        <span style="opacity:.95;">${d.launched}</span>
      `;
      modalBadge.textContent = `${d.series}${d.tag ? " ‚Ä¢ " + d.tag : ""}`;

      // Optional visual
      const vis = overrideVisual || d.visual;
      if (vis){
        modalVisual.style.display = "block";
        modalVisual.innerHTML = `<img src="${vis}" alt="Gift visual">`;
      } else {
        modalVisual.style.display = "none";
        modalVisual.innerHTML = "";
      }

      // Optional gallery
      if (Array.isArray(d.gallery) && d.gallery.length){
        modalGalleryWrap.style.display = "block";
        modalGallery.innerHTML = d.gallery.map(src => `
          <div class="thumb" data-src="${src}">
            <img src="${src}" alt="thumbnail">
          </div>
        `).join("");

        modalGallery.querySelectorAll(".thumb").forEach(el => {
          el.addEventListener("click", () => openModal(d, el.getAttribute("data-src")));
        });
      } else {
        modalGalleryWrap.style.display = "none";
        modalGallery.innerHTML = "";
      }

      modalLaunched.textContent = d.launched;
      modalWhat.textContent = d.what;
      modalBenefits.textContent = d.benefits;
      modalImpact.textContent = d.impact;
      modalForWhom.textContent = d.forWhom;

      modal.classList.add("show");
      modal.setAttribute("aria-hidden", "false");
    }

    function closeModal(){
      modal.classList.remove("show");
      modal.setAttribute("aria-hidden", "true");
    }

    function randomReveal(){
      const unopened = DOORS.filter(d => !state.opened.has(d.id));
      const pool = unopened.length ? unopened : DOORS;
      const d = pool[Math.floor(Math.random() * pool.length)];
      state.opened.add(d.id);
      save();
      updateProgress();
      renderGrid();
      openModal(d);
    }

    function resetAndShuffle(){
      state.opened.clear();
      state.order = shuffle(DOORS.map(d => d.id));
      save();
      updateProgress();
      renderGrid();
      closeModal();
    }

    // Events
    document.querySelector("#random").addEventListener("click", randomReveal);
    document.querySelector("#reset").addEventListener("click", resetAndShuffle);

    document.querySelector("#close").addEventListener("click", closeModal);
    modal.addEventListener("click", (e) => { if (e.target === modal) closeModal(); });
    document.addEventListener("keydown", (e) => { if (e.key === "Escape") closeModal(); });

    // Init
    ensureOrder();
    updateProgress();
    renderGrid();
  </script>
</body>
</html>
