<!-- index.html
Spine Decade Calendar ‚Äî streamlined, uniform grid (based on your latest feedback)

Fixes in this version:
‚úÖ Uniform box size (all tiles same)
‚úÖ Streamlined layout (clean grid, no bento)
‚úÖ Calendar tile shows ONLY: icon + category + number (no names)
‚úÖ Icon is bigger + centered and visually justified
‚úÖ Names/details appear ONLY after clicking (modal)
‚úÖ Shuffled order + auto-mark opened
‚úÖ Top is simple: Random + Reset only (no filters)

How to run:
- Save as index.html and open in browser.
-->

<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Spine Decade Calendar</title>

  <style>
    :root{
      --bg:#0e1014;
      --text:#eef2ff;
      --muted:#aab2c5;
      --border:rgba(255,255,255,.09);
      --accent:#7c5cff;
      --accent2:#00d4ff;
      --ok:#2dd4bf;
      --shadow: 0 20px 60px rgba(0,0,0,.55);
      --radius:18px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial;
      background:
        radial-gradient(1200px 700px at 10% 10%, rgba(124,92,255,.18), transparent 55%),
        radial-gradient(900px 600px at 90% 30%, rgba(0,212,255,.12), transparent 55%),
        var(--bg);
      color:var(--text);
      min-height:100vh;
    }

    header{
      max-width:1200px;
      margin:0 auto;
      padding:26px 18px 10px;
      display:flex;
      gap:16px;
      align-items:flex-end;
      justify-content:space-between;
      flex-wrap:wrap;
    }
    .brand h1{ margin:0; font-size:28px; letter-spacing:.2px; }
    .brand p{
      margin:8px 0 0;
      color:var(--muted);
      font-size:14px;
      line-height:1.45;
      max-width:860px;
    }

    .actions{
      display:flex;
      gap:10px;
      align-items:center;
      flex-wrap:wrap;
      justify-content:flex-end;
    }
    .btn{
      cursor:pointer;
      border:1px solid var(--border);
      background:rgba(255,255,255,.04);
      color:var(--text);
      padding:10px 12px;
      border-radius:12px;
      font-weight:850;
      transition:transform .06s ease, background .15s ease, border-color .15s ease;
    }
    .btn:hover{ background:rgba(255,255,255,.07); }
    .btn:active{ transform:translateY(1px); }
    .btn.primary{
      border-color:rgba(124,92,255,.55);
      background:linear-gradient(135deg, rgba(124,92,255,.35), rgba(0,212,255,.22));
    }

    .wrap{
      max-width:1200px;
      margin:0 auto;
      padding:10px 18px 40px;
    }

    .panel{
      background: linear-gradient(180deg, rgba(255,255,255,.045), rgba(255,255,255,.02));
      border:1px solid var(--border);
      border-radius: var(--radius);
      box-shadow: var(--shadow);
      overflow:hidden;
    }

    .panel-head{
      padding:14px 16px;
      border-bottom:1px solid var(--border);
      display:flex;
      align-items:center;
      justify-content:space-between;
      gap:12px;
      background:rgba(255,255,255,.02);
    }
    .panel-head h2{
      margin:0;
      font-size:14px;
      letter-spacing:.2px;
      color:var(--muted);
      font-weight:950;
      text-transform:uppercase;
    }

    .progress{
      display:flex;
      align-items:center;
      gap:10px;
      color:var(--muted);
      font-size:13px;
      white-space:nowrap;
    }
    .bar{
      width:260px;
      height:10px;
      background:rgba(255,255,255,.06);
      border-radius:999px;
      overflow:hidden;
      border:1px solid rgba(255,255,255,.07);
    }
    .bar > i{
      display:block;
      height:100%;
      width:0%;
      background:linear-gradient(90deg, rgba(124,92,255,.95), rgba(0,212,255,.9));
      border-radius:999px;
      transition:width .2s ease;
    }

    /* Uniform grid */
    .grid{
      padding:16px;
      display:grid;
      grid-template-columns: repeat(5, minmax(0, 1fr));
      gap:12px;
    }

    .tile{
      position:relative;
      border-radius:16px;
      background:linear-gradient(180deg, rgba(255,255,255,.05), rgba(255,255,255,.02));
      border:1px solid var(--border);
      padding:14px;
      cursor:pointer;
      user-select:none;
      transition:transform .08s ease, border-color .15s ease, background .15s ease;
      overflow:hidden;

      height:140px;            /* uniform */
      display:flex;
      flex-direction:column;
      align-items:center;
      justify-content:center;  /* justified center */
      gap:10px;
      text-align:center;
    }
    .tile:hover{
      transform:translateY(-1px);
      border-color:rgba(124,92,255,.35);
      background:linear-gradient(180deg, rgba(124,92,255,.10), rgba(255,255,255,.02));
    }

    .icon{
      width:58px;
      height:58px;
      border-radius:18px;
      display:grid;
      place-items:center;
      border:1px solid rgba(255,255,255,.10);
      background:rgba(255,255,255,.03);
      font-size:30px;          /* bigger but controlled */
      line-height:1;
      box-shadow: 0 12px 30px rgba(0,0,0,.25);
    }

    .cat{
      font-size:12px;
      color:var(--muted);
      border:1px solid var(--border);
      background:rgba(255,255,255,.03);
      padding:6px 10px;
      border-radius:999px;
      max-width:100%;
      overflow:hidden;
      text-overflow:ellipsis;
      white-space:nowrap;
    }

    .doorno{
      position:absolute;
      top:12px; left:12px;
      font-size:12px;
      color:rgba(255,255,255,.75);
      font-weight:900;
      letter-spacing:.12em;
      padding:6px 8px;
      border-radius:10px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.03);
    }

    .tile .check{
      position:absolute;
      top:12px; right:12px;
      width:26px; height:26px;
      border-radius:10px;
      display:grid; place-items:center;
      border:1px solid rgba(45,212,191,.35);
      background:rgba(45,212,191,.12);
      color:var(--ok);
      opacity:0;
      transform:scale(.95);
      transition:opacity .15s ease, transform .15s ease;
    }
    .tile.opened .check{ opacity:1; transform:scale(1); }

    .tile .glow{
      position:absolute;
      inset:auto -60px -60px auto;
      width:160px; height:160px;
      border-radius:50%;
      background:radial-gradient(circle at 30% 30%, rgba(0,212,255,.18), transparent 60%);
      filter:blur(2px);
      pointer-events:none;
    }

    /* Modal */
    .modal{
      position:fixed; inset:0;
      background:rgba(0,0,0,.55);
      display:none;
      align-items:center;
      justify-content:center;
      padding:18px;
      z-index:50;
    }
    .modal.show{ display:flex; }
    .modal-card{
      width:min(820px, 100%);
      border-radius:22px;
      border:1px solid var(--border);
      background:linear-gradient(180deg, rgba(20,24,36,.96), rgba(10,12,18,.96));
      box-shadow: var(--shadow);
      overflow:hidden;
      position:relative;
    }
    .modal-top{
      padding:14px 16px;
      border-bottom:1px solid var(--border);
      display:flex;
      justify-content:space-between;
      align-items:center;
      gap:10px;
    }
    .modal-title{
      font-weight:950;
      line-height:1.2;
    }
    .badge{
      display:inline-flex; align-items:center; gap:8px;
      padding:8px 10px; border-radius:999px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.03);
      color:var(--muted);
      font-size:12px;
      margin-top:8px;
      flex-wrap:wrap;
    }
    .x{
      width:36px; height:36px;
      border-radius:12px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.04);
      color:var(--text);
      cursor:pointer;
      display:grid;
      place-items:center;
      font-weight:950;
      font-size:18px;
    }
    .modal-body{ padding:16px; }

    .visual{
      width:100%;
      border-radius:16px;
      border:1px solid var(--border);
      background:rgba(255,255,255,.02);
      overflow:hidden;
      margin:10px 0 14px;
    }
    .visual img{
      width:100%;
      display:block;
      max-height:280px;
      object-fit:cover;
    }

    .gallery{
      display:grid;
      grid-template-columns: repeat(4, minmax(0,1fr));
      gap:10px;
    }
    .thumb{
      border-radius:14px;
      overflow:hidden;
      border:1px solid var(--border);
      background:rgba(255,255,255,.02);
      cursor:pointer;
      transition:transform .08s ease, border-color .15s ease;
    }
    .thumb:hover{ transform:translateY(-1px); border-color:rgba(124,92,255,.35); }
    .thumb img{ width:100%; height:86px; object-fit:cover; display:block; }

    .block{
      margin:12px 0;
      padding:12px;
      border-radius:16px;
      background:rgba(255,255,255,.02);
      border:1px solid var(--border);
    }
    .block .k{
      font-size:12px;
      color:var(--muted);
      text-transform:uppercase;
      letter-spacing:.12em;
      font-weight:950;
    }
    .block .v{
      margin-top:6px;
      font-size:14px;
      line-height:1.55;
      color:var(--text);
      white-space:pre-line;
    }

    footer{
      max-width:1200px;
      margin:0 auto;
      padding:0 18px 28px;
      color:var(--muted);
      font-size:12px;
      opacity:.85;
    }

    @media (max-width: 980px){
      .grid{ grid-template-columns: repeat(4, minmax(0, 1fr)); }
      .bar{ width:180px; }
    }
    @media (max-width: 640px){
      .grid{ grid-template-columns: repeat(3, minmax(0, 1fr)); }
      .bar{ width:140px; }
    }
    @media (max-width: 420px){
      .grid{ grid-template-columns: repeat(2, minmax(0, 1fr)); }
      .tile{ height:135px; }
      .icon{ width:54px; height:54px; font-size:28px; }
    }
  </style>
</head>

<body>
  <header>
    <div class="brand">
      <h1>üéÅ Spine Decade Calendar</h1>
      <p>A decade of innovation, milestones, and growth at Spine</p>
    </div>

    <div class="actions">
      <button class="btn primary" id="random">Random reveal</button>
      <button class="btn" id="reset">Reset + Shuffle</button>
    </div>
  </header>

  <main class="wrap">
    <section class="panel">
      <div class="panel-head">
        <h2>Calendar</h2>
        <div class="progress">
          <span id="count">0/25 revealed</span>
          <div class="bar"><i id="barFill"></i></div>
        </div>
      </div>
      <div class="grid" id="grid"></div>
    </section>
  </main>

  <!-- Modal -->
  <div class="modal" id="modal" aria-hidden="true">
    <div class="modal-card" role="dialog" aria-modal="true" aria-label="Door details">
      <div class="modal-top">
        <div>
          <div class="modal-title" id="modalTitle"></div>
          <div class="badge" id="modalBadge"></div>
        </div>
        <button class="x" id="close">√ó</button>
      </div>

      <div class="modal-body">
        <div class="visual" id="modalVisual" style="display:none"></div>

        <div class="block" id="modalGalleryWrap" style="display:none">
          <div class="k">Gallery</div>
          <div class="v" style="margin-top:10px;">
            <div class="gallery" id="modalGallery"></div>
          </div>
        </div>

        <div class="block">
          <div class="k">Launched</div>
          <div class="v" id="modalLaunched"></div>
        </div>

        <div class="block">
          <div class="k">Short description</div>
          <div class="v" id="modalDesc"></div>
        </div>

        <div class="block">
          <div class="k">Impact & Benefits</div>
          <div class="v" id="modalBenefits"></div>
        </div>

        <div class="block">
          <div class="k">Who it benefits</div>
          <div class="v" id="modalWho"></div>
        </div>
      </div>
    </div>
  </div>

  <footer>
    Optional: add screenshots via <code>visual</code> and thumbnails via <code>gallery</code>.
  </footer>

  <script>
    // Door data (hidden until reveal)
    const DOORS = [
      { id:1, emoji:"üß†", series:"NextGen ERP", tag:"Launch",
        launched:"SpineNEXTGEN ERP platform released.",
        desc:"Next-generation ERP connecting planning, production, quality, warehouse, finance, HR, sales and procurement under one system.",
        benefits:"‚Ä¢ Faster workflows and approvals\n‚Ä¢ Better visibility across departments\n‚Ä¢ Reduced manual work via automation\n‚Ä¢ Stronger control with audit trails",
        who:"Ops + Finance + QA + HR", visual:null, gallery:null
      },
      { id:2, emoji:"üß©", series:"NextGen ERP", tag:"Modules",
        launched:"Core modules rolled out on NextGen.",
        desc:"Inventory Control, PPC, QC/QA, WMS, HRM, Accounts & Finance, Sales, Purchase.",
        benefits:"‚Ä¢ End-to-end function coverage\n‚Ä¢ Unified data for reporting\n‚Ä¢ Less duplication between teams",
        who:"Ops + HR + Finance + QA", visual:null, gallery:null
      },
      { id:3, emoji:"‚öôÔ∏è", series:"NextGen ERP", tag:"Automation",
        launched:"Automation workflows enabled across ERP.",
        desc:"Auto vouchers, notifications/alerts, auto-emails and customizable reports to reduce repetitive effort.",
        benefits:"‚Ä¢ Faster processing cycles\n‚Ä¢ Lower manual entry errors\n‚Ä¢ More consistent reporting",
        who:"Finance + Operations", visual:null, gallery:null
      },
      { id:4, emoji:"‚úÖ", series:"NextGen ERP", tag:"Compliance",
        launched:"Compliance-ready controls activated in NextGen.",
        desc:"Audit trail, access controls, GST/tax support and e-invoicing readiness for controlled operations.",
        benefits:"‚Ä¢ Better traceability\n‚Ä¢ Easier audits\n‚Ä¢ Cleaner compliance workflows",
        who:"Finance + QA + Compliance", visual:null, gallery:null
      },
      { id:5, emoji:"üìà", series:"NextGen ERP", tag:"Scale",
        launched:"High-volume operational stability achieved.",
        desc:"Designed to handle heavy daily transactions and multi-location working with stronger performance.",
        benefits:"‚Ä¢ Stable operations at scale\n‚Ä¢ Faster data handling\n‚Ä¢ More reliable day-to-day usage",
        who:"Business + All Users", visual:null, gallery:null
      },

      { id:6, emoji:"üßæ", series:"Online Billing", tag:"Billing",
        launched:"PharmaTrader online billing software released.",
        desc:"Billing and distributor operations software designed for invoices, trade workflows and secondary sales processes.",
        benefits:"‚Ä¢ Faster billing\n‚Ä¢ Reduced billing mistakes\n‚Ä¢ Better distributor workflow tracking",
        who:"Trade Team + Distributors", visual:null, gallery:null
      },
      { id:7, emoji:"üßæ", series:"Online Billing", tag:"Billing",
        launched:"SpineTrader released for billing + trade management.",
        desc:"Trade management suite supporting billing operations with structured processes and consistent data.",
        benefits:"‚Ä¢ Standardized billing\n‚Ä¢ Better transaction visibility\n‚Ä¢ Improved operational control",
        who:"Trade + Retail Network", visual:null, gallery:null
      },
      { id:8, emoji:"üõ°Ô∏è", series:"Online Billing", tag:"Reliability",
        launched:"Upgrades and migrations done without disruption.",
        desc:"Planned upgrades to keep trade/billing operations running smoothly with minimal downtime.",
        benefits:"‚Ä¢ Business continuity protected\n‚Ä¢ Reduced disruption during upgrades\n‚Ä¢ Faster recovery",
        who:"Trade + IT", visual:null, gallery:null
      },

      { id:9, emoji:"üì±", series:"Mobile Apps", tag:"Mobile",
        launched:"Venus Ayushmaan app released.",
        desc:"Mobile access to product catalog and promotions for customers and distributors.",
        benefits:"‚Ä¢ Faster product access in the field\n‚Ä¢ Better promo visibility\n‚Ä¢ More informed ordering",
        who:"Sales + Customers + Distributors", visual:null, gallery:null
      },
      { id:10, emoji:"üñäÔ∏è", series:"Mobile Apps", tag:"Mobile",
        launched:"Pen Order Booking app released.",
        desc:"Digitized pen order booking to reduce manual coordination and improve speed.",
        benefits:"‚Ä¢ Faster booking\n‚Ä¢ Cleaner order records\n‚Ä¢ Less manual follow-ups",
        who:"Sales + Distributors", visual:null, gallery:null
      },
      { id:11, emoji:"‚ö°", series:"Mobile Apps", tag:"Mobile",
        launched:"Spine SFA app released for field teams.",
        desc:"Sales force automation for fast reporting and activity capture, reducing time spent on DPR and updates.",
        benefits:"‚Ä¢ Faster reporting\n‚Ä¢ Better daily visibility\n‚Ä¢ Reduced paperwork",
        who:"Field Force + Managers", visual:null, gallery:null
      },
      { id:12, emoji:"üíº", series:"Mobile Apps", tag:"Mobile",
        launched:"Entrepreneur Program (EP) app released.",
        desc:"Supports EP workflows like debit notes and departmental P/L insights in one place.",
        benefits:"‚Ä¢ Better program tracking\n‚Ä¢ Faster financial visibility\n‚Ä¢ Reduced manual reconciliation",
        who:"Business + Finance", visual:null, gallery:null
      },
      { id:13, emoji:"üë•", series:"Mobile Apps", tag:"Mobile",
        launched:"SpineHRM app released.",
        desc:"Mobile HR workflows for employee operations and requests.",
        benefits:"‚Ä¢ Faster HR turnaround\n‚Ä¢ Less paperwork\n‚Ä¢ Better employee experience",
        who:"HR + Employees", visual:null, gallery:null
      },
      { id:14, emoji:"üèÜ", series:"Mobile Apps", tag:"Mobile",
        launched:"PPL performance app released.",
        desc:"Gamified performance visibility to improve engagement and motivation.",
        benefits:"‚Ä¢ Clear performance visibility\n‚Ä¢ Higher engagement\n‚Ä¢ Faster recognition cycles",
        who:"Sales + Teams", visual:null, gallery:null
      },
      { id:15, emoji:"üöö", series:"Mobile Apps", tag:"Mobile",
        launched:"Venus DTS app released.",
        desc:"Stockist ordering, tracking and payment workflows to manage partner operations.",
        benefits:"‚Ä¢ Smoother ordering lifecycle\n‚Ä¢ Better tracking\n‚Ä¢ Faster partner servicing",
        who:"Stockists + Sales + Trade", visual:null, gallery:null
      },
      { id:16, emoji:"üåê", series:"Mobile Apps", tag:"Mobile",
        launched:"Davai mobile app released.",
        desc:"B2B pharma transactions on mobile for faster execution and easier access on the go.",
        benefits:"‚Ä¢ Faster transactions\n‚Ä¢ Better accessibility\n‚Ä¢ Less dependency on desktop-only flows",
        who:"Trade + Partners", visual:null, gallery:null
      },
      { id:17, emoji:"üì¶", series:"Mobile Apps", tag:"Portfolio",
        launched:"A portfolio of business mobile apps delivered.",
        desc:"Connected set of apps across sales, trade, HR and programs designed to reduce manual work and speed up workflows.",
        benefits:"‚Ä¢ Mobile-first execution\n‚Ä¢ Faster field operations\n‚Ä¢ Better cross-team visibility",
        who:"Sales + Trade + HR + Ops", visual:null, gallery:null
      },

      { id:18, emoji:"üï∏Ô∏è", series:"Corporate Websites", tag:"Web",
        launched:"50+ corporate and product websites launched.",
        desc:"Website rollout at scale to expand digital presence across brands, products, initiatives and business units.",
        benefits:"‚Ä¢ Stronger brand visibility\n‚Ä¢ Faster publishing and updates\n‚Ä¢ Better customer access to information",
        who:"Marketing + Business + Customers",
        visual:null,
        
      },
      { id:19, emoji:"üì£", series:"Corporate Websites", tag:"SEO/Leads",
        launched:"SEO and enquiry funnels strengthened.",
        desc:"Publishing and optimization workflows improved to drive better search visibility and enquiries.",
        benefits:"‚Ä¢ Higher organic visibility\n‚Ä¢ More inbound enquiries\n‚Ä¢ Better lead capture experience",
        who:"Marketing + Sales", visual:null, gallery:null
      },

      { id:20, emoji:"ü§ñ", series:"AI Software", tag:"Smart Bidding",
        launched:"Bidcraft smart bidding software released.",
        desc:"AI-assisted bidding system designed to improve bid decisions using data signals, rules and optimization logic.",
        benefits:"‚Ä¢ Smarter bid recommendations\n‚Ä¢ Reduced manual analysis time\n‚Ä¢ More consistent decision-making",
        who:"Business Teams + Leadership", visual:null, gallery:null
      },
      { id:21, emoji:"üß†", series:"AI Software", tag:"AI Intelligence",
        launched:"Athena AI solution released.",
        desc:"Intelligence layer to support analysis, insights and decision workflows across business use-cases.",
        benefits:"‚Ä¢ Faster insights from data\n‚Ä¢ Improved visibility for decision-makers\n‚Ä¢ Support for automation and analysis",
        who:"Leadership + Analytics + Teams", visual:null, gallery:null
      },
      { id:22, emoji:"üå™Ô∏è", series:"AI Software", tag:"AI Engine",
        launched:"Vortex AI solution released.",
        desc:"AI engine built for faster processing, pattern detection and intelligent workflows.",
        benefits:"‚Ä¢ Faster processing\n‚Ä¢ Better anomaly/pattern detection\n‚Ä¢ More intelligent operational workflows",
        who:"IT + Operations + Business", visual:null, gallery:null
      },

      { id:23, emoji:"üßØ", series:"Backbone", tag:"Reliability",
        launched:"Monitoring and alerts enabled for critical services.",
        desc:"Proactive monitoring to detect issues early and reduce downtime surprises.",
        benefits:"‚Ä¢ Faster issue detection\n‚Ä¢ Quicker response\n‚Ä¢ Better uptime",
        who:"Infra + DBA + IT Support", visual:null, gallery:null
      },
      { id:24, emoji:"üõ°Ô∏è", series:"Backbone", tag:"Security",
        launched:"Security hardening implemented.",
        desc:"Network and security upgrades to protect systems and ensure stable connectivity.",
        benefits:"‚Ä¢ Reduced risk\n‚Ä¢ Stronger controls\n‚Ä¢ Better reliability",
        who:"IT + Security + All Users", visual:null, gallery:null
      },
      { id:25, emoji:"üèÅ", series:"Wrap", tag:"Impact",
        launched:"Spine ecosystem matured into a full business platform.",
        desc:"ERP + billing + mobile + websites + AI working together to support operations and growth.",
        benefits:"‚Ä¢ Faster operations\n‚Ä¢ Better visibility\n‚Ä¢ Stronger control and compliance\n‚Ä¢ Scalable digital foundation",
        who:"Everyone", visual:null, gallery:null
      },
    ];

    // State (shuffled order + opened)
    const STORAGE_OPENED = "spine_decade_opened_v5";
    const STORAGE_ORDER  = "spine_decade_order_v5";
    const state = {
      opened: new Set(JSON.parse(localStorage.getItem(STORAGE_OPENED) || "[]")),
      order: JSON.parse(localStorage.getItem(STORAGE_ORDER) || "null")
    };

    const $ = (sel) => document.querySelector(sel);
    const grid = $("#grid");
    const countEl = $("#count");
    const barFill = $("#barFill");

    const modal = $("#modal");
    const modalTitle = $("#modalTitle");
    const modalBadge = $("#modalBadge");
    const modalVisual = $("#modalVisual");
    const modalGalleryWrap = $("#modalGalleryWrap");
    const modalGallery = $("#modalGallery");
    const modalLaunched = $("#modalLaunched");
    const modalDesc = $("#modalDesc");
    const modalBenefits = $("#modalBenefits");
    const modalWho = $("#modalWho");

    function save(){
      localStorage.setItem(STORAGE_OPENED, JSON.stringify([...state.opened]));
      localStorage.setItem(STORAGE_ORDER, JSON.stringify(state.order));
    }

    function shuffle(array){
      const a = array.slice();
      for (let i = a.length - 1; i > 0; i--){
        const j = Math.floor(Math.random() * (i + 1));
        [a[i], a[j]] = [a[j], a[i]];
      }
      return a;
    }

    function ensureOrder(){
      if (Array.isArray(state.order) && state.order.length === DOORS.length) return;
      state.order = shuffle(DOORS.map(d => d.id));
      save();
    }

    function updateProgress(){
      const total = DOORS.length;
      const opened = state.opened.size;
      countEl.textContent = `${opened}/${total} revealed`;
      barFill.style.width = `${Math.round((opened/total)*100)}%`;
    }

    function renderGrid(){
      grid.innerHTML = "";
      const idToDoor = new Map(DOORS.map(d => [d.id, d]));

      state.order.forEach((id) => {
        const d = idToDoor.get(id);
        if (!d) return;

        const opened = state.opened.has(d.id);
        const tile = document.createElement("div");
        tile.className = `tile ${opened ? "opened" : ""}`;
        tile.tabIndex = 0;

        tile.innerHTML = `
          <div class="doorno">${String(d.id).padStart(2,"0")}</div>
          <div class="check">‚úì</div>
          <div class="icon">${d.emoji || "üéÅ"}</div>
          <div class="cat" title="${d.series}">${d.series}</div>
          <div class="glow"></div>
        `;

        const open = () => {
          state.opened.add(d.id);
          save();
          updateProgress();
          tile.classList.add("opened");
          openModal(d);
        };

        tile.addEventListener("click", open);
        tile.addEventListener("keydown", (e) => {
          if (e.key === "Enter" || e.key === " ") {
            e.preventDefault();
            open();
          }
        });

        grid.appendChild(tile);
      });
    }

    function openModal(d, overrideVisual=null){
      modalTitle.textContent = `${d.emoji || "üéÅ"} Door ${String(d.id).padStart(2,"0")} revealed`;
      modalBadge.textContent = `${d.series}${d.tag ? " ‚Ä¢ " + d.tag : ""}`;

      const vis = overrideVisual || d.visual;
      if (vis){
        modalVisual.style.display = "block";
        modalVisual.innerHTML = `<img src="${vis}" alt="Door visual">`;
      } else {
        modalVisual.style.display = "none";
        modalVisual.innerHTML = "";
      }

      if (Array.isArray(d.gallery) && d.gallery.length){
        modalGalleryWrap.style.display = "block";
        modalGallery.innerHTML = d.gallery.map(src => `
          <div class="thumb" data-src="${src}">
            <img src="${src}" alt="thumbnail">
          </div>
        `).join("");

        modalGallery.querySelectorAll(".thumb").forEach(el => {
          el.addEventListener("click", () => openModal(d, el.getAttribute("data-src")));
        });
      } else {
        modalGalleryWrap.style.display = "none";
        modalGallery.innerHTML = "";
      }

      modalLaunched.textContent = d.launched;
      modalDesc.textContent = d.desc;
      modalBenefits.textContent = d.benefits;
      modalWho.textContent = d.who;

      modal.classList.add("show");
      modal.setAttribute("aria-hidden", "false");
    }

    function closeModal(){
      modal.classList.remove("show");
      modal.setAttribute("aria-hidden", "true");
    }

    function randomReveal(){
      const unopened = DOORS.filter(d => !state.opened.has(d.id));
      const pool = unopened.length ? unopened : DOORS;
      const d = pool[Math.floor(Math.random() * pool.length)];
      state.opened.add(d.id);
      save();
      updateProgress();
      renderGrid();
      openModal(d);
    }

    function resetAndShuffle(){
      state.opened.clear();
      state.order = shuffle(DOORS.map(d => d.id));
      save();
      updateProgress();
      renderGrid();
      closeModal();
    }

    // Events
    $("#random").addEventListener("click", randomReveal);
    $("#reset").addEventListener("click", resetAndShuffle);

    $("#close").addEventListener("click", closeModal);
    modal.addEventListener("click", (e) => { if (e.target === modal) closeModal(); });
    document.addEventListener("keydown", (e) => { if (e.key === "Escape") closeModal(); });

    // Init
    ensureOrder();
    updateProgress();
    renderGrid();
  </script>
</body>
</html>
